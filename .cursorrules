# RÃ¨gles de dÃ©veloppement - Inventory Manager

## ğŸ¯ Contexte du projet

Application de gestion d'inventaire Next.js 16 avec Supabase, TypeScript et Shadcn/ui.
Version actuelle : 0.1.12
Production : https://stock.exabird.be/

## ğŸ“‹ Processus de dÃ©veloppement OBLIGATOIRE

### Versioning STRICT

- **TOUJOURS** incrÃ©menter la version avant tout commit fonctionnel
- **Format** : VX.Y.Z (Semantic Versioning)
  - X.0.0 : Mises Ã  jour majeures (NÃ‰CESSITE confirmation utilisateur)
  - 0.X.0 : Nouvelles features complÃ¨tes (NÃ‰CESSITE confirmation utilisateur)
  - 0.0.Z : ItÃ©rations, corrections, amÃ©liorations (peut Ãªtre incrÃ©mentÃ© automatiquement)
- **Commandes** : `npm run version:patch`, `npm run version:minor`, `npm run version:major`

### Workflow obligatoire

1. **DÃ©veloppement local**
   - DÃ©velopper et tester avec `npm run dev`
   - Tester manuellement dans le navigateur

2. **Tests locaux OBLIGATOIRES**
   ```bash
   npm run build:check  # Compilation
   npm run lint        # Linting
   npm run type-check  # TypeScript
   ```

3. **Validation utilisateur**
   - **TOUJOURS ATTENDRE** la validation explicite de l'utilisateur
   - **NE JAMAIS DÃ‰PLOYER** sans validation

4. **Versioning et commit**
   ```bash
   npm run version:patch
   git add .
   git commit -m "ğŸ“¦ VX.X.X - Description"
   ```

5. **DÃ©ploiement via MCP**
   - Push vers GitHub via MCP GitHub
   - VÃ©rifier les logs Vercel aprÃ¨s 45 secondes
   - Confirmer le bon fonctionnement

## ğŸ› ï¸ Stack technique

- **Framework** : Next.js 16.0.0 (App Router)
- **React** : 19.2.0
- **TypeScript** : 5.x (strict mode)
- **UI** : Shadcn/ui + Tailwind CSS 4.x
- **Backend** : Supabase (PostgreSQL + Storage)
- **Scanner** : html5-qrcode
- **Forms** : React Hook Form + Zod

## ğŸ“ Conventions de code

### TypeScript

- **Typage strict obligatoire** : Toujours typer explicitement
- **null vs undefined** : Utiliser `null` pour les valeurs optionnelles en BDD, `undefined` pour l'UI
- **Interfaces** : PascalCase (ex: `Product`, `Category`)

### Nommage

- **Fichiers composants** : PascalCase (ex: `ProductCard.tsx`)
- **Fichiers services** : camelCase (ex: `services.ts`, `stockService.ts`)
- **Variables** : camelCase (ex: `productList`, `isLoading`)
- **Constantes** : UPPER_SNAKE_CASE (ex: `MAX_PRODUCTS`, `API_BASE_URL`)
- **Fonctions** : camelCase avec verbe (ex: `loadProducts()`, `handleSubmit()`)

### Composants React

- **Toujours fonctionnels** avec hooks (pas de classes)
- **Ordre des hooks** : Ã‰tats â†’ Effets â†’ Callbacks â†’ Render
- **Props interface** : Toujours typer les props explicitement

### Styles Tailwind

- **Ordre des classes** : Layout â†’ Spacing â†’ Sizing â†’ Typography â†’ Visual â†’ States
- **Mobile-first** : Classes de base pour mobile, puis breakpoints (md:, lg:)

### Gestion des erreurs

- **try-catch obligatoire** pour toutes les opÃ©rations async
- **Logs structurÃ©s** avec emojis :
  - ğŸ“¦ Chargement/requÃªte
  - âœ… SuccÃ¨s
  - âŒ Erreur
  - âš ï¸ Warning
  - ğŸ” Debug
  - â• CrÃ©ation
  - âœï¸ Modification
  - ğŸ—‘ï¸ Suppression

### Commentaires

- **En franÃ§ais** uniquement
- **Descriptifs** : Expliquer le pourquoi, pas le comment
- **JSDoc** pour les fonctions complexes avec exemples

## ğŸ—ï¸ Architecture

### Structure de dossiers

```
src/
â”œâ”€â”€ app/              # Pages Next.js (App Router)
â”‚   â”œâ”€â”€ page.tsx      # Page principale (liste produits)
â”‚   â”œâ”€â”€ dashboard/    # Tableau de bord
â”‚   â”œâ”€â”€ settings/     # ParamÃ¨tres
â”‚   â””â”€â”€ api/          # Routes API
â”œâ”€â”€ components/       # Composants React
â”‚   â”œâ”€â”€ inventory/    # Composants gestion stock
â”‚   â”œâ”€â”€ scanner/      # Scanner codes-barres
â”‚   â”œâ”€â”€ layout/       # Composants layout
â”‚   â””â”€â”€ ui/           # Composants UI Shadcn
â””â”€â”€ lib/              # Services et utilitaires
    â”œâ”€â”€ services.ts   # ProductService, CategoryService
    â”œâ”€â”€ supabase.ts   # Client Supabase + Types
    â””â”€â”€ *.ts          # Autres services
```

### Services principaux

- **ProductService** : CRUD produits, recherche, historique
- **CategoryService** : Gestion catÃ©gories
- **StockService** : OpÃ©rations de stock, historique, raisons
- **ProductImageService** : Upload et gestion images
- **ScrapingService** : Scraping IA avec Claude (Phase 2)

### Base de donnÃ©es Supabase

Tables principales :
- `products` : Produits avec mÃ©tadonnÃ©es JSONB
- `categories` : CatÃ©gories
- `product_history` : Historique des modifications
- `stock_operations` : Historique des opÃ©rations de stock
- `stock_reasons` : Raisons prÃ©dÃ©finies pour opÃ©rations
- `pieces` : PiÃ¨ces individuelles avec numÃ©ros de sÃ©rie
- `product_images` : MÃ©tadonnÃ©es des images

## ğŸš« Ã€ NE JAMAIS FAIRE

- âŒ DÃ©ployer sans validation utilisateur
- âŒ Oublier de mettre Ã  jour la version avant commit
- âŒ IncrÃ©menter version mineure/majeure sans confirmation
- âŒ Utiliser `any` en TypeScript
- âŒ CrÃ©er des composants classe React
- âŒ Commenter en anglais
- âŒ Modifier les processus dans DEVELOPMENT_PROCESSES.md sans validation
- âŒ Sauter les tests locaux obligatoires
- âŒ CrÃ©er des fichiers de log dans le dossier racine
- âŒ Ignorer les erreurs TypeScript

## âœ… Bonnes pratiques

### Performance

- Utiliser `useMemo` et `useCallback` pour optimiser les re-renders
- Lazy loading pour les composants lourds
- Optimistic updates pour une UI rÃ©active
- Debounce pour les recherches et inputs frÃ©quents

### SÃ©curitÃ©

- Validation cÃ´tÃ© serveur obligatoire (ne jamais faire confiance au client)
- RLS Supabase toujours activÃ© et bien configurÃ©
- Variables d'environnement pour les secrets (jamais de commit)
- Sanitization des entrÃ©es utilisateur

### AccessibilitÃ©

- Labels toujours associÃ©s aux inputs
- Attributs ARIA appropriÃ©s
- Navigation au clavier complÃ¨te
- Ratios de contraste WCAG respectÃ©s

### UX

- Feedback visuel pour toutes les actions
- Messages d'erreur clairs et en franÃ§ais
- Ã‰tats de chargement visibles
- Mobile-first design

## ğŸ“š Documentation obligatoire

### Mettre Ã  jour lors de changements

- **CHANGELOG.md** : Ã€ chaque version (obligatoire)
- **README.md** : Si changement d'installation/utilisation
- **docs/ARCHITECTURE_GUIDE.md** : Si changement d'architecture
- **Commentaires de code** : Pour toute fonction complexe

### Ne PAS crÃ©er

- âŒ Guides de test dÃ©taillÃ©s pour chaque modification
- âŒ Multiples versions d'un mÃªme guide
- âŒ Documentation de chaque bug corrigÃ©
- âŒ Guides "UX FIX" ou "CORRECTIONS" dÃ©taillÃ©s

## ğŸ” Debugging

### Outils disponibles

- `./test-app.sh` : Tests automatiques complets
- `node monitor-realtime-console.js` : Monitoring temps rÃ©el
- `./debug.config.js` : Configuration centralisÃ©e de debug

### En cas de problÃ¨me

1. Consulter `docs/DEBUGGING_GUIDE.md`
2. VÃ©rifier les logs navigateur (F12)
3. VÃ©rifier les logs Supabase via MCP
4. Consulter `PROBLEMES_CORRIGES.md` pour les problÃ¨mes connus
5. Utiliser le monitoring temps rÃ©el

## ğŸ¯ Fichiers de rÃ©fÃ©rence essentiels

- **START_HERE.md** : Point d'entrÃ©e pour dÃ©marrage
- **docs/ARCHITECTURE_GUIDE.md** : Architecture complÃ¨te
- **docs/DEVELOPMENT_PROCESSES.md** : Processus obligatoires
- **docs/DEBUGGING_GUIDE.md** : Guide de debugging
- **SYNTHESE_RESTRUCTURATION.md** : Ã‰tat actuel du projet

## ğŸ“¦ Commandes essentielles

```bash
# DÃ©veloppement
npm run dev                          # Lancer l'app
npm run build:check                  # VÃ©rifier compilation
npm run lint                         # VÃ©rifier linting
npm run type-check                   # VÃ©rifier TypeScript

# Tests
./test-app.sh                        # Tests complets
node monitor-realtime-console.js    # Monitoring

# Versioning
npm run version:patch                # V0.0.X
npm run version:minor                # V0.X.0 (nÃ©cessite confirmation)
npm run version:major                # VX.0.0 (nÃ©cessite confirmation)
npm run version:show                 # Afficher version actuelle
```

## ğŸ¨ Design System

- **Composants** : Toujours utiliser Shadcn/ui
- **Couleurs** : Variables CSS Shadcn (primary, secondary, muted)
- **IcÃ´nes** : Lucide React
- **Animations** : Framer Motion si nÃ©cessaire
- **Responsive** : Mobile-first avec breakpoints Tailwind

## ğŸ”— IntÃ©grations

- **MCP Supabase** : Logs API, Database, Storage
- **MCP Vercel** : Logs dÃ©ploiement, mÃ©triques
- **MCP GitHub** : Push automatique, CI/CD

## âš ï¸ PrioritÃ©s de dÃ©veloppement

1. **StabilitÃ©** : Pas de bugs critiques
2. **UX** : Interface intuitive et responsive
3. **Performance** : Chargements rapides
4. **Documentation** : Code bien documentÃ©
5. **SÃ©curitÃ©** : RLS et validations strictes

---

**Ces rÃ¨gles sont OBLIGATOIRES et doivent Ãªtre suivies systÃ©matiquement.**
**Consulter docs/DEVELOPMENT_PROCESSES.md pour les dÃ©tails complets.**

